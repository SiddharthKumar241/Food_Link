<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Missing Link in Food Chain</title>
  <link rel="stylesheet" href="rajo.css">
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const receiverBtn = document.getElementById('receiver-btn');
      if (!receiverBtn) {
        console.error("Receiver button with id 'receiver-btn' not found!");
        return;
      }

      receiverBtn.addEventListener('click', () => {
        if (!navigator.geolocation) {
          alert("Geolocation not supported by your browser.");
          return;
        }

        navigator.geolocation.getCurrentPosition(async (pos) => {
          const latitude = pos.coords.latitude;
          const longitude = pos.coords.longitude;

          const userId = "user123";
          const name = "Receiver Name";
          const role = "receiver";

          try {
            const response = await fetch('/store-location', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ userId, name, latitude, longitude, role })
            });

            const data = await response.json();
            if (response.ok) {
              window.location.href = `/results?lat=${latitude}&lon=${longitude}`;
            } else {
              alert("Error: " + data.error);
            }
          } catch (err) {
            alert("Failed to store location: " + err.message);
          }
        }, (err) => {
          alert("Error fetching location: " + err.message);
        });
      });
    });
  </script>

</head>

<body>
  <div class="navbar">
    <div class="logo">Food Donation Platform</div>
    <div class="button-group">
      <button class="logup-btn" onclick="openPopup()">Logup</button>
      <button class="logup-btn" onclick="window.location.href='https://www.siddharthkumar.tech/'">Developer</button>
    </div>
  </div>

  <div class="background-animation"></div>
  <div class="main_box">
    <div class="bold">
      <div class="container">
        <br><br>
        <h1 class="title">The Missing Link in Food Chain</h1><br>
        <div class="buttons">
          <a href="./donor.html" class="btn donor-btn">Donor</a>
          <a id="receiver-btn" class="btn receiver-btn" href="./Receiver.html">Receiver</a>
        </div><br><br>
      </div>
      <div class="popup-container" id="logupPopup">
        <span class="close-btn" onclick="closePopup()">×</span>
        <h2>Logup</h2>
        <form id="logupForm">
          <input type="text" id="name" placeholder="Name" required>
          <input type="email" id="email" placeholder="Email" required>
          <input type="text" id="username" placeholder="Username" required>
          <input type="password" id="password" placeholder="Password" required>
          <button type="submit">Submit</button>
        </form>
      </div>
      <div class="donation-options">
        <div class="donation-box">
          <h3>Give Today</h3>
          <p>10₹ can help provide 10 meals!</p>
          <button>DONATE NOW</button>
        </div>
        <div class="donation-box">
          <h3>Give Monthly</h3>
          <p>Join our Hunger Council with a monthly gift.</p>
          <button>DONATE NOW</button>
        </div>
        <div class="donation-box">
          <h3>Fundraise</h3>
          <p>Start a fundraiser and inspire others to give.</p>
          <button>LEARN MORE</button>
        </div>
        <div class="donation-box">
          <h3>Volunteer</h3>
          <p>Give your time and serve your community.</p>
          <button>GET STARTED</button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <p>&copy; 2025 SARC LIMITED | All Rights Reserved.</p>
    <p>We bridge the gap between those in need and those who wish to make a difference.</p>
  </div>

  <script>
    function openPopup() {
      document.getElementById("logupPopup").classList.add("active");
    }

    function closePopup() {
      document.getElementById("logupPopup").classList.remove("active");
    }

    document.getElementById("logupForm")?.addEventListener("submit", function (event) {
      event.preventDefault();

      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      fetch('/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, email, username, password })
      }).then(response => response.json())
        .then(data => {
          alert(data.message);
          closePopup();
        });
    });

    function createShapes() {
      const shapes = ['circle', 'square', 'triangle', 'pentagon', 'hexagon', 'star'];
      const animationContainer = document.querySelector('.background-animation');

      for (let i = 0; i < 15; i++) {
        let shapeDiv = document.createElement('div');
        let shapeType = shapes[Math.floor(Math.random() * shapes.length)];
        shapeDiv.classList.add('shape', shapeType);
        shapeDiv.style.top = Math.random() * 100 + 'vh';
        shapeDiv.style.left = Math.random() * 100 + 'vw';
        shapeDiv.style.animationDuration = (5 + Math.random() * 5) + 's';
        shapeDiv.style.setProperty('--x', (Math.random() * 2 - 1).toFixed(2));
        shapeDiv.style.setProperty('--y', (Math.random() * 2 - 1).toFixed(2));
        animationContainer.appendChild(shapeDiv);
      }
    }

    createShapes();
  </script>

</body>

</html>

